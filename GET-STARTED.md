# Get Started - Flask AWS Cognito Authentication

This is your complete guide to get the Flask authentication app running with AWS Cognito in minutes.

## ğŸš€ Quick Start (3 Steps)

### Step 1: Set Up AWS Cognito

Run the automated setup script:

```bash
./setup-cognito.sh
```

This will:
- Create a Cognito User Pool
- Create an App Client
- Generate secure keys
- Create the `.env` file with all credentials
- Optionally create a test user

### Step 2: Verify Setup

Check that everything is configured correctly:

```bash
./verify-setup.sh
```

This script checks:
- âœ… Environment variables
- âœ… AWS Cognito resources
- âœ… Docker installation
- âœ… Project files

### Step 3: Launch the Application

Start the application with Docker:

```bash
docker-compose up --build
```

Open your browser and navigate to:
```
http://localhost:8000
```

## ğŸ“‹ What You Get

- **Modern Sign-In Page**: Clean, responsive UI with email and password fields
- **AWS Cognito Authentication**: Secure user authentication with session management
- **Protected Dashboard**: Only accessible after successful login
- **Docker Container**: Production-ready deployment with Gunicorn
- **Error Handling**: User-friendly error messages for authentication issues

## ğŸ”§ Common Commands

### Application Management
```bash
# Start application (foreground)
docker-compose up --build

# Start application (background)
docker-compose up -d

# Stop application
docker-compose down

# View logs
docker-compose logs -f

# Restart application
docker-compose restart
```

### User Management
```bash
# List users
aws cognito-idp list-users \
    --user-pool-id $(grep COGNITO_USER_POOL_ID .env | cut -d '=' -f2) \
    --region $(grep AWS_REGION .env | cut -d '=' -f2)

# Create a new user (see SETUP-GUIDE.md for full command)
```

### Testing
```bash
# Run locally without Docker
python app.py

# Test health endpoint
curl http://localhost:8000/health
```

## ğŸ“š Documentation

- **[README.md](README.md)** - Project overview and features
- **[SETUP-GUIDE.md](SETUP-GUIDE.md)** - Detailed AWS Cognito setup instructions with manual CLI commands
- **[QUICK-REFERENCE.md](QUICK-REFERENCE.md)** - Common commands and one-liners
- **[GET-STARTED.md](GET-STARTED.md)** - This file

## ğŸ›  Scripts

- **`setup-cognito.sh`** - Automated AWS Cognito setup
- **`cleanup-cognito.sh`** - Delete Cognito resources
- **`verify-setup.sh`** - Verify configuration

## ğŸ” Environment Variables

After running `setup-cognito.sh`, your `.env` file will contain:

```env
FLASK_SECRET_KEY=<auto-generated>
COGNITO_USER_POOL_ID=<auto-created>
COGNITO_CLIENT_ID=<auto-created>
COGNITO_CLIENT_SECRET=<auto-created>
AWS_REGION=<your-region>
```

## ğŸ› Troubleshooting

### "Cannot connect to Docker daemon"
```bash
# Start Docker Desktop (macOS/Windows)
# Or start Docker service (Linux)
sudo systemctl start docker
```

### "User does not exist"
Create a test user:
```bash
./setup-cognito.sh
# Choose 'y' when prompted to create a test user
```

### "USER_PASSWORD_AUTH flow not enabled"
This means the App Client wasn't configured correctly. Re-run:
```bash
./cleanup-cognito.sh
./setup-cognito.sh
```

### Port 8000 already in use
```bash
# Find and kill the process using port 8000
lsof -ti:8000 | xargs kill -9

# Or change the port in docker-compose.yml
ports:
  - "9000:8000"  # Use port 9000 instead
```

### AWS CLI not configured
```bash
aws configure
# Enter your AWS credentials when prompted
```

## ğŸ“¦ Project Structure

```
cognito-front-end/
â”œâ”€â”€ app.py                    # Main Flask application
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ base.html            # Base template with styling
â”‚   â”œâ”€â”€ login.html           # Sign-in page
â”‚   â””â”€â”€ dashboard.html       # Protected dashboard
â”œâ”€â”€ requirements.txt         # Python dependencies
â”œâ”€â”€ Dockerfile              # Container configuration
â”œâ”€â”€ docker-compose.yml      # Docker Compose setup
â”œâ”€â”€ .env                    # Environment variables (created by setup script)
â”œâ”€â”€ .env.example            # Template for environment variables
â”œâ”€â”€ .gitignore             # Git ignore rules
â”œâ”€â”€ setup-cognito.sh       # Automated Cognito setup
â”œâ”€â”€ cleanup-cognito.sh     # Cleanup script
â”œâ”€â”€ verify-setup.sh        # Verification script
â”œâ”€â”€ README.md              # Project overview
â”œâ”€â”€ SETUP-GUIDE.md         # Detailed setup instructions
â”œâ”€â”€ QUICK-REFERENCE.md     # Command reference
â””â”€â”€ GET-STARTED.md         # This file
```

## ğŸ¯ Application Flow

1. **User visits** `http://localhost:8000`
2. **Redirected to** `/login` (if not authenticated)
3. **User enters** email and password
4. **Flask app calls** AWS Cognito for authentication
5. **Cognito validates** credentials
6. **Session created** on successful login
7. **User redirected** to `/dashboard`
8. **Dashboard shows** user information
9. **Logout** clears session and redirects to login

## ğŸ”’ Security Features

- âœ… Password hashing handled by AWS Cognito
- âœ… Secure session management with Flask
- âœ… SECRET_HASH support for added security
- âœ… Non-root Docker user
- âœ… Environment variable configuration
- âœ… HTTPS-ready (configure reverse proxy for production)

## ğŸš¢ Production Deployment

For production:

1. **Use environment-specific `.env` files**
2. **Enable HTTPS** with a reverse proxy (nginx, Apache)
3. **Set FLASK_DEBUG=False**
4. **Use strong FLASK_SECRET_KEY**
5. **Enable MFA** in Cognito
6. **Configure CloudWatch logging**
7. **Use IAM roles** instead of access keys (if on AWS)
8. **Set up monitoring and alerts**

## ğŸ’¡ Next Steps

After getting the app running:

1. **Customize the UI** - Edit templates in `templates/`
2. **Add more routes** - Extend `app.py`
3. **Implement sign-up** - Add user registration flow
4. **Add password reset** - Implement forgot password feature
5. **Enable MFA** - Add multi-factor authentication
6. **Add user profile** - Display and edit user information

## ğŸ†˜ Getting Help

If you encounter issues:

1. Run `./verify-setup.sh` to check configuration
2. Check Docker logs: `docker-compose logs -f`
3. Review [SETUP-GUIDE.md](SETUP-GUIDE.md) for detailed instructions
4. Check AWS Cognito console for user pool status
5. Verify AWS credentials: `aws sts get-caller-identity`

## ğŸ§¹ Cleanup

When you're done testing:

```bash
# Stop the application
docker-compose down

# Delete AWS Cognito resources
./cleanup-cognito.sh
```

---

**Ready to start?** Run `./setup-cognito.sh` now! ğŸš€
